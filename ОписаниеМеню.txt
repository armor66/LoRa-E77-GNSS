  По умолчанию Spreading Factor 11, Coding Rate 4/7, без CRC. можно выбрать одно из трех, четырех или пяти устройств.
Период обновления даных со всех устройств будет соответственно 3, 4 или 5 секунд.
  Если выбрать Spreading Factor 12, Coding Rate остается 4/7 CRC включен, номер устройства 3 из трех.
Оно будет работать только на прием с одним или двумя маяками если на них также выбран Spreading Factor 12 и их номера
1 или 2 (при SF12 маяки издают двойной короткий сигнал если их номер больше двух), период обновления 3 секунды.
  В меню Actions появится выбор, на какой маяк подавать звуковой сигнал. Передача с устройства 3 идет только при выборе 
"Beeper1 on" или "Beeper2 on" во время передачи данных другим маяком (с инверсным IQ), а также по таймауту приемника,
что позволяет маяку синхронизировать своё время и корректно принимать звуковой сигнал если он потерял сигнал GNSS.
  При Spreading Factor 12 прием и передача на каждом устройстве идут с инвертированием IQ и не мешают друг другу 
(если маяки не расположены слишком близко друг к другу).
  На контакт BUZZ_IN разъема SWD маяка можно подать сигнал BUZZ(активный GND) с внешнего устройства(полетного контроллера).
при подаче питания на разъем SWD маяк автоматически включается и подзаряжается его аккумулятор.

Синий светодиод - фронт PPS или начало цикла если нет PPS, гаснет через 50мс;
Зеленый светодиод - фронт PPS + 50мс, гаснет в конце приема GNSS данных (UBLOX PVT) или через 50мс;
Красный светодиод - индикация передачи, окончания приема и начала цикла совместно с синим;
Желтый светодиод горит во время зарядки.

  -включение с зажатой кнопкой ESC/DOWN - настройка GNSS модуля, в меню настройки одновременно 
зажатые кнопки OK/UP и ESC/DOWN (в меню не отображается) сбрасывают GNSS модуль до заводских установок;
 
  -включение с зажатой кнопкой OK/UP - сканирование каналов с шагом 5 для обнаружения помех или 
других работающих устройств;

  -включение с зажатыми кнопками OK/UP и ESC/DOWN - для проверки работоспособности гироскопа (дать полежать неподвижно),
акселерометра (дождаться появления данных и подержать последовательно в шести разных положениях) и магнетометра.
Калибровочные значения сохраняются, но периодически приходится покрутить устройство чтобы показания компаса были корректны
(появляется предупреждение "Turn Around"), при скорости больше GPS_SPEED_THRS(2км/ч) курс берется с GNSS модуля.

кнопка PWR(short):
-отключение подсветки. Если подсветка выключена, можно сохранить текущую точку маршрута кнопкой UP(OK)
или удалить все координаты выбранной группы или сохраненные координаты всех пяти устройств кнопкой DOWN(ESC):
	-кнопка UP(short) количеством нажатий выбирается группа 1...5 для сохранения текущих координат, затем 
	 кнопка OK(long):
		2 коротких сигнала - координаты недостоверны;
		количество длинных сигналов подтверждает номер выбранной группы;
		один короткий - запись в выбранную группу;
		1 длинный сигнал без коротких - группа заполнена(7 записей), следует выбрать следующую;
		2 коротких сигнала - превышен номер группы.
	-кнопка DOWN(short) количеством нажатий выбирается группа 1...6 для удаления всех координат в группе, 
		7 - для очистки координат всех пяти сохраненных устройств (7 длинных сигналов подтверждения), затем
	 кнопка ESC(long):
		количество длинных сигналов подтверждает номер выбранной группы(7 - очистка сохраненых координат всех устройств);
		2 коротких сигнала - превышен номер группы.

Успешная запись или стирание делают текущим меню Points с подсветкой выбранной группы
Перед очисткой конкретной группы удобно зайти в меню Points, где в левой колонке показано необходимое количество 
коротких нажатий для стирания точек соответствующей группы 1...6(Стирание всех точек в меню Actions) 
или координат всех пяти устройств (7 нажатий).

кнопка PWR(long):
-включение (удерживать до мигания белого светодиода);
-вызов меню Actions -> Power OFF;
-в меню Actions повторное удержание PWR(long) устанавливает флаг EMERGENCY;
-включение подсветки (если текущее меню Navigations и установлен "FlwTrek on", повторный поиск ближайшей точки 
записанного трека одновременно с включением подсветки).

меню Main:

  В новой версии установлен DS3231 и время отображается сразу после включения до приема GNSS данных(fix valid) цветом CYAN,
без него отображается "RTC IS NOT APPLIED"(ORANGE).
  Если GPS не сконфигурирован (выделено ORANGE, издается двойной короткий сигнал), следует выключить и настроить 
в меню конфигурации GNSS.
  При недостоверных GNSS данных(fix valid не установлен), строка 3DFix и pDop отображается цветом CYAN.
  OnTheAir показывает количество активных(fix valid) устройств, включая своё.
- кнопка UP(short), кнопка DOWN(short) - навигация вверх/вниз;
- кнопка OK(long) - вход в соответствующее подменю;
- кнопка ESC(long) - изменение яркости подсветки средняя(после включения)/низкая/высокая и т.д.

меню Navigation:

Отображение относительного положения других устройств, навигация по сохраненному треку
- кнопка UP(short), кнопка DOWN(short) - цикличное изменение масштаба от 30м до 1920м
- кнопка OK(long) - вход в экраны отдельно каждого устройства или маячка, отображающие положение устройств(маячков)
		 и 1 или 7(если скорость сохраненого устройства была больше GPS_SPEED_THRS(3км/ч)) последних сохраненных
		 координат. На этих экранах масштаб изменяется автоматически в зависимости от рассчитанной дальности.
		 Координаты сохраняются если они перестали поступать по истечении установленного TimeOut в меню SETTINGS
		 (если TimeOut не "0"). Если сигнал принимаемого устройства содержит метку маяка, TimeOut всегда 30 секунд;
- кнопка OK(long) - цикличное переключение между другими устройствами (масштаб изменяется автоматически);
- кнопка ESC(long) - возврат в предыдущее меню Navigation/Main;

меню Devices:

Подробное состояние устройств.
- кнопка UP(short), кнопка DOWN(short) - цикличное переключение между всеми устройствами;
- кнопка OK(long) - сохранение (если принят соответствующий valid_fix_flag) до 7 координат устройств в каждую
		 из групп 0...6	(через дробь - количество уже сохраненных позиций в группе):
	- кнопка UP(short), кнопка DOWN(short) - выбор группы;
	- кнопка OK(long) - вход, кнопка ESC(long) - выход без сохранения;
		-кнопка UP(short), кнопка DOWN(short) - выбор позиции 
		 (красная означает, что она занята и будет перезаписана);
		-кнопка OK(long) - сохранение;
	- кнопка ESC(long) - возврат в предыдущее меню Devices/Main.

меню Nav2points:

Отображение относительного положения сохраненных точек по группам 0...6
- кнопка UP(short), кнопка DOWN(short) - изменение масштаба от 30м до 1920м;
- кнопка OK(long) - последовательный перебор групп;
- кнопка ESC(long) - возврат в предыдущее меню Main;

меню Points:

 №        - номер группы для сохраненных координат точек или устройств;
 POINTS   - имя группы или устройства;
 SAVED    - количество сохраненных точек в данной группе или устройстве;
 i "-1"   - в группе нет сохраненных точек, в устройствах отображаются последние принятые координаты
						(не будут сохранены во флэш если TimeOut не установлен);
 i "0-31" - индекс последней сохраненной или очищенной(занятой) записи во флэш памяти;

	Запись производится группами по 7 точек (9 байт каждая + 1 байт - флаг группы или устройства)
	по 32 записи(индекса) размером 64 байта на каждой странице флэш памяти размером 2048 байт,
	при переполнении вся страница групп точек или устройств очищается.

группа Alarms - для отслеживания сигналов Emergency, (Alarm и Gather не используется), приходящих с других устройств;
группа BcnMan - для ручного сохранения текущих координат маячка;
-отображается количества сохраненных точек в каждой группе:
	-кнопка OK(long) - вход в подменю с показом сохраненных координат;
	-ещё раз OK(long) - предложение очистить все сохраненные координаты в группе;
	-кнопка ESC(long) - возврат в предыдущее меню Points;
-кнопка ESC(long):
	если нет сохраненных точек, возврат в меню Main;
	если есть сохраненные точки в выбранной группе 0...6, переход на соответствующий экран группы в Nav2points;
	если есть сохраненные точки в выбранной группе устройств 1...5, переход на соответствующий экран
		 устройства или маячка в подменю Navigation.

меню Settings:(изменение параметров устройства)

- кнопка UP(short), кнопка DOWN(short) - навигация вверх/вниз
- кнопка OK(long) - вход в подменю:
	кнопка UP(short), кнопка DOWN(short) - изменить значение;
	кнопка ESC(long) - выход без сохранения;
	кнопка OK(long) - сохранить значение;
- кнопка ESC(long) - если изменений не было, выход в меню Main.
	Для применения параметров радиоканала требуется перезагрузка
	Если были сохранены изменения необходимо либо их подтвердить OK(long) либо вызвать перезагрузку ESC(long)
		с возвратом предыдущих значений;
	TimeOut - если не равен 0, это устройство отслеживает другие, координаты других устройств сохраняются если они 
		перестали поступать по истечении установленного времени и издаются 3 коротких сигнала.
	Если сигнал принимаемого устройства содержит метку маяка, TimeOut всегда 30 секунд.
подменю Fence пока не используется (только как MUTE). Если и в TimeOut и в Fence выставлено "0", отключается BUZZER.

меню Actions:(можно войти по удержанию PWR(long) из любого меню)

удержание PWR(long) устанавливает флаг EMERGENCY
- кнопка OK(long) в положении Power OFF выключает питание;
- кнопка OK(long) - цикличное переключение off/on соответствующего пункта меню.

Флаги Emergency(Alarm и Gather не задействованы), Beeper, A(nti)Theft и BeaconLive передаются на другие устройства,
на устройстве принявшем флаг EMERGENCY:
	-текущим меню становится Nav2points->Alarms;
	-периодически включается подсветка экрана, при нажатии на любую кнопку подсветка постоянна и не блокируется;
	(количество коротких сигналов соответствует номеру устройства установившего флаг - не задействовано)
	-в меню Main отображается, какое устройство передает флаг Emergency;
- "Beeper" вызывает длинный сигнал на других устройствах во время приемного слота передающего его устройства;
- "A(nti)Theft" активирует режим "action" акселерометра соответствующего маяка, что устанавливает флаг "Emergency" 
при его перемещении;
- "BeaconLive" устанавливает "tBcn* halt" соответствующего маяка, что переводит его в меню Actions -> Power OFF
и позволяет выключить его просто нажатием UP(OK) или двойным тапом по оси X акселерометра;
- "Del points" вызывает меню стирания всех сохраненных точек;
- "SetDefault(s)" предлагает возврат к значениям по умолчанию;
- "FlwTrek" по умолчанию включен, если в прошивке залит трек (TREKPOINTS_TOTAL > 1), иначе отключен;
- кнопка ESC(long) - выход в меню Main.

Скрипт gnss.sh берет координаты из обычного *.gps файла и сохраняет их в gnss.h
(gnss.h из Core/Inc должен находиться в том же каталоге, что и gnss.sh)
Координаты необходимо проредить командами после строки "#remove the even numbered lines from the file"
чтобы #define TREKPOINTS_TOTAL в файле gnss.h получился не более 255 (или обрезать вручную)
Файл *.gps выбирается как параметр при запуске gnss.sh или интерактивно. Если файл не выбран, содержимое 
latitude_array и longitude_array в gnss.h обнуляется и FlwTrek в меню Actions становится неактивным.
