- по умолчанию Spreading Factor 11, Coding Rate 4/6. можно выбрать одно из трех, четырех или пяти устройств. период 
обновления даных со всех устройств будет соответственно 3, 4 или 5 секунд.
- если выбрать Spreading Factor 12, Coding Rate , установится 4/7 и номер устройства 3 из трех. оно будет работать 
только на прием с одним или двумя маяками если на них также выбран Spreading Factor 12 и их номер устройства 1 или 2. 
период обновления 3 секунды
 в меню Actions появится выбор, на какой маяк подавать звуковой сигнал. передача идет только при выборе "Beeper1 on" 
или "Beeper2 on" во время передачи данных другим маяком. при Spreading Factor 12 прием и передача идут с 
инвертированием IQ и не мешают друг другу. на контакт BUZZ_IN разъема SWD маяка можно подать сигнал BUZZ(активный GND) 
с внешнего устройства(полетного контроллера). при подаче питания на разъем SWD маяк автоматически включается и 
подзаряжается его аккумулятор.

-синий светодиод - фронт PPS, гаснет через 50мс
-зеленый светодиод - фронт PPS, гаснет в конце приема GPS данных (UBLOX PVT)
-красный светодиод - индикация передачи
-желтый светодиод горит во время зарядки

-включение с зажатой кнопкой ESC/DOWN - настройка GNSS модуля
одновременно зажатые кнопки OK/UP и ESC/DOWN (в меню не отображается) сбрасывают GNSS модуль до заводских установок
 
-включение с зажатой кнопкой OK/UP - сканирование каналов с шагом 5 для обнаружения помех или 
других работающих устройств

-включение с зажатыми кнопками OK/UP и ESC/DOWN - исключительно для проверки работоспособности гироскопа
(калибруется долго, дать полежать неподвижно), акселерометра и магнетометра. калибровочные значения не используются, 
так как после включения периодически приходится покрутить устройство чтобы показания компаса были корректны
(появляется предупреждение "Turn Around"), при скорости больше GPS_SPEED_THRS(3км/ч) курс берется с GNSS модуля.

кнопка PWR(short):
-отключение подсветки, если подсветка выключена:
	-кнопка UP(short) количеством нажатий выбирается группа 1...5 для сохранения текущих координат, затем 
	кнопка OK(long):
		3 коротких сигнала - координаты недостоверны
		количество длинных сигналов подтверждает номер выбранной группы
		количество коротких - номер записи в выбранной группе
		1 длинный сигнал без коротких - группа заполнена, следует выбрать другую
		5 коротких сигналов - превышен номер группы
	-кнопка DOWN(short) количеством нажатий выбирается группа 1...11 для удаления всех координат в группе, 
		затем кнопка ESC(long):
		((количество длинных сигналов подтверждает номер очищаемой группы) - просто короткий сигнал)
		5 коротких сигналов - превышен номер группы
Успешная запись или стирание делают текущим меню Points с подсветкой выбранной группы
Перед очисткой конкретной группы удобно зайти в меню Points, где в левой колонке показано необходимое количество 
коротких нажатий для стирания точек соответствующей группы. !на время звуковых сигналов блокируются прием и передача!

кнопка PWR(long):
-включение
-вызов меню Actions -> Power OFF
-в меню Actions повторное удержание PWR(long) устанавливает флаг EMERGENCY
-включение подсветки (если текущее меню Navigations и установлен "FlwTrek on", повторный поиск ближайшей точки 
записанного трека одновременно с включением подсветки)

меню Main:

если GPS не сконфигурирован (выделено ORANGE + синий светодиод), выключить и вoйти в меню конфигурации GPS
при недостоверных GPS данных(fix valid не установлен), строка 3DFix и pDop отображается цветом CYAN
OnTheAir показывает количество активных(fix valid) устройств, включая своё
кнопка UP(short), кнопка DOWN(short) - навигация вверх/вниз
кнопка OK(long) - вход в соответствующее подменю
кнопка ESC(long) - изменение яркости подсветки средняя(после включения)/низкая/высокая и т.д.

меню Navigation:
-отображение относительного положения других устройств, навигация по сохраненному треку
кнопка UP(short), кнопка DOWN(short) - цикличное изменение масштаба от 30м до 1920м
кнопка OK(long) - вход в экраны отдельно каждого устройства или маячка, отображающие положение устройств(маячков)
		 и 1 или 7(если скорость сохраненого устройства была больше GPS_SPEED_THRS(3км/ч)) последних 
		 сохраненных координат. Координаты сохраняются если они перестали поступать по истечении 
		 установленного TimeOut в меню SETTINGS (если TimeOut не "0"). Если сигнал принимаемого устройства 
		 содержит метку маяка, TimeOut=30 всегда
кнопка OK(long) - циклическое переключение между другими устройствами
кнопка ESC(long) - возврат в предыдущее меню Navigation/Main

меню Devices:

-подробное состояние устройств
кнопка UP(short), кнопка DOWN(short) - циклическое переключение между всеми устройствами
кнопка OK(long) - сохранение (если принят соответствующий valid_fix_flag) до 7 координат устройств в каждую
		 из групп 0...6	(через дробь - количество уже сохраненных позиций в группе):
	-кнопка UP(short), кнопка DOWN(short) - выбор группы
	-кнопка OK(long) - вход, кнопка ESC(long) - выход без сохранения
		-кнопка UP(short), кнопка DOWN(short) - выбор позиции 
		 (красная означает, что она занята и будет перезаписана)
		-кнопка OK(long) - сохранение
	-кнопка ESC(long) - возврат в предыдущее меню Devices/Main

меню Nav2points:

-отображение относительного положения сохраненных точек по группам 0...6
кнопка UP(short), кнопка DOWN(short) - изменение масштаба от 30м до 1920м
кнопка OK(long) - последовательный перебор групп
кнопка ESC(long) - возврат в предыдущее меню Main

меню Points:

группа Alarms - для отслеживания сигналов Emergency, (Alarm и Gather не используется), приходящих с других устройств
группа BcnMan - для ручного сохранения текущих координат маячка (использовать для Alarm или Gather)
-отображается количества сохраненных точек в каждой группе
	-кнопка OK(long) - вход в подменю с показом сохраненных координат
	-кнопка ESC(long) - возврат в предыдущее меню Points
-кнопка ESC(long):
	если нет сохраненных точек, возврат в меню Main
	если есть сохраненные точки в выбранной группе 0...6, переход на соответствующий экран группы в Nav2points
	если есть сохраненные точки в выбранной группе устройств 1...5, переход на соответствующий экран
		 устройства или маячка в подменю Navigation

меню Settings:(изменение параметров устройства)

кнопка UP(short), кнопка DOWN(short) - навигация вверх/вниз
кнопка OK(long) - вход в подменю
	кнопка UP(short), кнопка DOWN(short) - изменить значение
	кнопка ESC(long) - выход без сохранения
	кнопка OK(long) - сохранить значение
кнопка ESC(long) - если изменений не было, выход в меню Main
	Для применения параметров радиоканала требуется перезагрузка
	Если были сохранены изменения необходимо либо их подтвердить OK(long)
	TimeOut - если не равен 0, это устройство отслеживает другие, координаты других устройств сохраняются если они 
		перестали поступать по истечении установленного времени и издаются 3 коротких и 1 длинный сигнал.
	Если сигнал принимаемого устройства содержит метку маяка, TimeOut всегда 30 секунд
(todo) подменю Fence не используется

меню Actions:(можно войти по удержанию PWR(long) из любого меню)

удержание PWR(long) устанавливает флаг EMERGENCY
кнопка OK(long) + Power OFF - выключение питания
кнопка OK(long) - циклическое переключение off/on,
		- "Del points" стирание всех сохраненных точек
		- "SetDefault(s)" возврат к значениям по умолчанию
-флаги Emergency (Alarm и Gather не задействованы) и Beeper передаются на другие устройства
	 (IS_BEACON установлен в прошивке, если это маяк)
-на устройстве принявшем флаг EMERGENCY:
	-текущим меню становится Nav2points->Alarms
	-периодически включается подсветка экрана, при нажатии на любую кнопку подсветка постоянна и не блокируется
	-количество коротких сигналов соответствует номеру устройства, установившего флаг
	-в меню Main отображается, какое устройство передает флаг Emergency
-флаг Beeper вызывает длинный сигнал на других устройствах во время приемного слота передающего его устройства
-флаг FlwTrek по умолчанию включен, если в прошивке залит трек (TREKPOINTS_TOTAL > 1), иначе отключен
кнопка ESC(long) - выход в меню Main

Если после сохранения точек (ручного или автоматического по таймауту) отображаются не корректые данные,
сделать стирание всех сохраненных точек (перегрузить устройство помогает только до следующего сохранения)

Скрипт gnss.sh берет координаты из обычного *.gps файла и сохраняет их в gnss.h
(gnss.h из Core/Inc должен находиться в том же каталоге)
Координаты необходимо проредить командами после строки "#remove the even numbered lines from the file"
чтобы #define TREKPOINTS_TOTAL в файле gnss.h получился не более 255 (или обрезать вручную)
*.gps файл выбирается как параметр при запуске gnss.sh или интерактивно. Если файл не выбран, содержимое 
latitude_array и longitude_array в gnss.h обнуляется и FlwTrek в меню становится неактивным.
